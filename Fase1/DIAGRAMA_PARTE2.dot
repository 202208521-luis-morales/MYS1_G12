digraph CorreccionEstilo {
    rankdir=TB;
    node [shape=box, style="rounded,filled", fontname="Arial", fontsize=11];
    edge [fontname="Arial", fontsize=10];
    
    // ============ ENTRADA ============
    Entrada [label="üì• Desde Evaluaci√≥n Editorial\n(Convergencia)", fillcolor="#81C784", shape=ellipse];
    TransferIn [label="üîΩ TransferNode\nEntrada_Correccion", fillcolor="#FFF176", shape=ellipse];
    
    Entrada -> TransferIn [penwidth=2];
    
    // ============ SERVIDOR CORRECTOR ============
    subgraph cluster_corrector {
        label="Server_Corrector (Capacity: 1)";
        style=filled;
        fillcolor="#FFEBEE";
        
        InputCorrector [label="üìç InputNode", fillcolor="#FFCDD2", shape=circle];
        ProcessCorrector [label="‚öôÔ∏è Processing Time:\n\nMath.If(Manuscrito.EsRecorreccion == True,\n    Random.Triangular(1, 2, 4),  ‚Üê Re-correcci√≥n\n    Random.Uniform(3, 5))        ‚Üê Primera vez\n\nUnits: Days\nCosto: 55.19 Q/h", fillcolor="#EF5350", fontcolor=white, fontsize=10];
        OutputCorrector [label="üìç OutputNode", fillcolor="#FFCDD2", shape=circle];
        
        InputCorrector -> ProcessCorrector;
        ProcessCorrector -> OutputCorrector;
    }
    
    TransferIn -> InputCorrector [label="100% manuscritos\nEsRecorreccion = False"];
    
    // ============ DELAY EDITOR ============
    subgraph cluster_editor {
        label="Server_EsperaEditor (Delay, no recurso)";
        style=filled;
        fillcolor="#E3F2FD";
        
        InputEditor [label="üìç InputNode", fillcolor="#BBDEFB", shape=circle];
        ProcessEditor [label="‚è≥ Processing Time:\nRandom.Uniform(1, 3) Days\n\nCapacity: Infinity\n'Editor aplica correcciones'", fillcolor="#42A5F5", fontcolor=white];
        OutputEditor [label="üìç OutputNode\n\n‚ö° State Assignment (On Exiting):\nManuscrito.NecesitaRetrabajo =\n  Random.Uniform(0,1) <= 0.15 ? 1 : 0", fillcolor="#BBDEFB", shape=circle];
        
        InputEditor -> ProcessEditor;
        ProcessEditor -> OutputEditor;
    }
    
    OutputCorrector -> InputEditor [label="Corrector entrega\nretroalimentaci√≥n"];
    
    // ============ DECISI√ìN ============
    Decide [label="‚ùì DECISI√ìN\n\nPath Selection Weight:\n‚Ä¢ Path A: NecesitaRetrabajo == 0\n‚Ä¢ Path B: NecesitaRetrabajo == 1", fillcolor="#FFF59D", shape=diamond, fontsize=10];
    
    OutputEditor -> Decide;
    
    // ============ SALIDAS ============
    TransferLoop [label="üîÑ TransferNode\nLoop_Recorreccion\n\n‚ö° State Assignment (On Entered):\nManuscrito.EsRecorreccion = True", fillcolor="#FFAB91", shape=ellipse];
    TransferOut [label="‚úÖ TransferNode\nSalida_Correccion\n(Hacia Diagramaci√≥n)", fillcolor="#C8E6C9", shape=ellipse];
    
    // Paths con probabilidades
    Decide -> TransferOut [label="Path A: NO retrabajo (85%)\nNecesitaRetrabajo == 0", color=green, penwidth=3];
    Decide -> TransferLoop [label="Path B: S√ç retrabajo (15%)\nNecesitaRetrabajo == 1", color=red, penwidth=3];
    
    // Loop de regreso
    TransferLoop -> InputCorrector [label="Regresa con flag:\nEsRecorreccion = True\n\nAhora usar√° Triangular(1,2,4)", color=red, style=bold, penwidth=2];
    
    // ============ NOTAS ============
    subgraph cluster_notas {
        label="üìå Variables de Estado (Entity: Manuscrito)";
        style=dashed;
        fillcolor="#FFFDE7";
        
        nota [label="‚Ä¢ EsRecorreccion: Boolean (False por defecto)\n‚Ä¢ NecesitaRetrabajo: Integer (0 o 1)\n\nL√≥gica:\n1. Primera vez ‚Üí U(3,5) d√≠as\n2. Si NecesitaRetrabajo = 1 ‚Üí Marca EsRecorreccion = True\n3. Segunda pasada ‚Üí Triangular(1,2,4) d√≠as\n4. Loop puede repetirse N veces (cada vez 15% probabilidad)", shape=note, fillcolor="#FFF9C4", fontsize=9];
    }
    
    TransferOut -> nota [style=invis];
    
    // ============ EJEMPLO DE EJECUCI√ìN ============
    subgraph cluster_ejemplo {
        label="üéØ Ejemplo de Ejecuci√≥n";
        style=dashed;
        fillcolor="#F3E5F5";
        
        ej [label="Manuscrito #42 (Libro):\n\n1. Entra con EsRecorreccion = False\n2. Corrector revisa: 4.2 d√≠as (U 3-5)\n3. Editor corrige: 2.1 d√≠as (U 1-3)\n4. Decisi√≥n: Random = 0.12 ‚Üí Retrabajo ‚úì\n5. Marca EsRecorreccion = True\n6. Regresa al Corrector\n7. Re-correcci√≥n: 2.8 d√≠as (Tri 1,2,4)\n8. Editor revisa: 1.5 d√≠as (U 1-3)\n9. Decisi√≥n: Random = 0.87 ‚Üí Aprobado ‚úì\n10. Sale a Diagramaci√≥n\n\nTiempo total: 10.6 d√≠as", shape=note, fillcolor="#E1BEE7", fontsize=9, style="filled,bold"];
    }
}